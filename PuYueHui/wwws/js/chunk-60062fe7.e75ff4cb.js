(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-60062fe7"],{"7cd1":function(t,a,s){},aaea:function(t,a,s){"use strict";var i=s("7cd1"),e=s.n(i);e.a},f5f6:function(t,a,s){"use strict";s.r(a);var i=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",[s("div",{staticClass:"flexlayout"},[s("div",{staticClass:"topbar"},[s("router-link",{staticClass:"icon icon-sousuo",attrs:{to:"/search"}}),s("div",[t._v("葡悦汇商城")]),s("span",{staticClass:"icon"})],1),s("div",{staticClass:"filterBar"},[s("span",{class:{cur:1==t.searchParam.field},on:{click:function(a){t.doSearch("1")}}},[t._v("综合")]),s("span",{staticClass:"i-rev",class:[{cur:2==t.searchParam.field},t.orderClass.soldNumBy?"i-rev":"i-sor"],on:{click:function(a){t.doSearch("2")}}},[t._v("销量")]),s("span",{class:[{cur:3==t.searchParam.field},t.orderClass.capacityBy?"i-rev":"i-sor"],on:{click:function(a){t.doSearch("3")}}},[t._v("容量")]),s("span",{class:[{cur:4==t.searchParam.field},t.orderClass.priceBy?"i-rev":"i-sor"],on:{click:function(a){t.doSearch("4")}}},[t._v("价格")]),s("span",{staticClass:"icon-shaixuan",on:{click:function(a){t.onShow()}}},[t._v("筛选")])]),s("div",{staticClass:"productBox"},[s("mt-loadmore",{ref:"loadmore",attrs:{"bottom-method":t.pageList,"auto-fill":!1,"bottom-all-loaded":t.allLoaded}},[t.products?s("div",{staticClass:"list_pho2",attrs:{id:"product_list"}},t._l(t.products,function(a,i){return s("router-link",{key:i,attrs:{to:{name:"ProductDetail",query:{id:a.id}}}},[s("div",{staticClass:"wrap_img"},[s("img",{attrs:{src:t.attachmentUrl+a.logo+".jpg",alt:a.name}})]),s("p",{staticClass:"cp_title"},[t._v(t._s(a.name))]),s("p",{staticClass:"price"},[t._v("会员价：￥"+t._s(a.price))]),s("p",{staticClass:"price2"},[t._v("\n              零售价：\n              "),s("span",[t._v(t._s(t._f("formatMoney")(a.originalPrice)))])])])})):t._e()])],1),s("MainMenu",{staticClass:"menuBox"})],1),s("mt-popup",{staticClass:"filterBox",attrs:{position:"right",modal:!0},model:{value:t.popupVisible,callback:function(a){t.popupVisible=a},expression:"popupVisible"}},[s("div",{staticStyle:{height:"100%",overflow:"auto"}},[s("h2",{staticClass:"filterTitle"},[s("strong",[t._v("类型")])]),s("div",{staticClass:"filerItem"},t._l(t.typeList,function(a,i){return s("span",{key:a.key,class:{"cur icon-cur":a.checked},on:{click:function(s){t.typeClick(a)}}},[t._v(t._s(a.value))])})),s("h2",{staticClass:"filterTitle"},[s("strong",[t._v("国家")])]),s("div",{staticClass:"filerItem"},t._l(t.areaList,function(a,i){return s("span",{key:a.key,class:{"cur icon-cur":a.checked},on:{click:function(s){t.typeClick(a)}}},[t._v(t._s(a.value))])})),s("h2",{staticClass:"filterTitle"},[s("strong",[t._v("价格")])]),s("div",{staticClass:"filerItem"},t._l(t.priceList,function(a,i){return s("span",{key:a.key,class:{"cur icon-cur":a.checked},on:{click:function(s){t.typeClick(a,1)}}},[t._v(t._s(a.value))])})),s("h2",{staticClass:"filterTitle"},[s("strong",[t._v("产地")])]),s("div",{staticClass:"filerItem"},t._l(t.chateauList,function(a,i){return s("span",{key:a.key,class:{"cur icon-cur":a.checked},on:{click:function(s){t.typeClick(a)}}},[t._v(t._s(a.value))])}))]),s("div",{staticClass:"btngroup"},[s("div",{staticClass:"btn2",on:{click:function(a){t.onHide()}}},[t._v("取消")]),s("div",{staticClass:"btn3",on:{click:function(a){t.search()}}},[t._v("确认")])])])],1)},e=[],r=(s("386d"),s("ac6a"),s("add6")),c=s("38cc"),o=s("3a78"),n=(s("76a0"),{name:"Shop",components:{MainMenu:r["a"],Listpho2:c["a"]},data:function(){return{attachmentUrl:this.GLOBAL.attachmentUrl,products:[],code:"",msg:"",baseUrl:o["a"].baseUrl,popupVisible:!1,priceList:[],areaList:[],chateauList:[],typeList:[],searchParam:{priceRange:"",area:"",chateauId:"",classify:"",pageNo:1,pageSize:10,orderBy:"1",field:"1"},allLoaded:!1,orderClass:{soldNumBy:!1,capacityBy:!1,priceBy:!1}}},computed:{},created:function(){var t=this,a={pageNo:1,pageSize:10,orderBy:t.searchParam.orderBy,field:t.searchParam.field};this.searchProduct(a),this.doConfig()},methods:{doSearch:function(t){this.resetPage(),this.searchParam.field=t,this.switchOrderStyle(t),this.searchProduct(this.searchParam)},searchProduct:function(t,a){var s=this;return new Promise(function(i,e){o["a"].products(t,function(t){s.products=a?s.products.concat(t.list):t.list,i(t.pages)},function(t){console.log("my---errorDatassss==="+JSON.stringify(t)),e()})})},doConfig:function(){var t=this;o["a"].searchConfig({},function(a){null!=a&&(t.priceList=t.wrap(a.price_type),t.areaList=t.wrap(a.country_type),t.chateauList=t.wrap(a.chateau_type),t.typeList=t.wrap(a.wine_type))},function(t){})},typeClick:function(t,a){1==a&&this.priceList.forEach(function(t,a){t.checked=!1}),t.checked=!t.checked},addToShoppingCart:function(t){var a={productId:t.id,productQuantity:1,currentPrice:t.price};o["a"].addToShoppingCart(a,function(t){console.log("添加购物车成功:",a)},function(t){console.error("添加购物车异常:",JSON.stringify(t))})},onShow:function(){this.popupVisible=!0},onHide:function(){this.popupVisible=!1,this.wrap(this.priceList),this.wrap(this.areaList),this.wrap(this.chateauList),this.wrap(this.typeList),this.search()},search:function(){this.popupVisible=!1,this.resetPage(),this.searchParam.classify=this.selectList(this.typeList),this.searchParam.priceRange=this.selectList(this.priceList),this.searchParam.chateauId=this.selectList(this.chateauList),this.searchParam.area=this.selectList(this.areaList),this.searchProduct(this.searchParam)},wrap:function(t){var a=this;return t.forEach(function(t){a.$set(t,"checked",!1)}),t},selectList:function(t){var a="";return t.forEach(function(t){t.checked&&(a.length>0&&(a+=","),a+=t.key)}),a},pageList:function(){event.stopImmediatePropagation(),this.searchParam.pageNo++;var t=this,a={pageNo:t.searchParam.pageNo,pageSize:10,orderBy:t.searchParam.orderBy,field:t.searchParam.field};this.searchProduct(a,!0).then(function(a){a==t.searchParam.pageNo&&(t.allLoaded=!0),t.$refs.loadmore.onBottomLoaded()}).catch(function(a){t.$refs.loadmore.onBottomLoaded()})},switchOrderStyle:function(t){switch(t){case"2":this.orderClass.soldNumBy=!this.orderClass.soldNumBy,this.searchParam.orderBy=this.getOrderBy(this.orderClass.soldNumBy);break;case"3":this.orderClass.capacityBy=!this.orderClass.capacityBy,this.searchParam.orderBy=this.getOrderBy(this.orderClass.capacityBy);break;case"4":this.orderClass.priceBy=!this.orderClass.priceBy,this.searchParam.orderBy=this.getOrderBy(this.orderClass.priceBy);break}},getOrderBy:function(t){return t?"1":"2"},resetPage:function(){this.searchParam.pageNo=1,this.searchParam.orderBy="1",this.searchParam.field="1",this.allLoaded=!1}}}),l=n,h=(s("aaea"),s("2877")),d=Object(h["a"])(l,i,e,!1,null,"f6254e40",null);d.options.__file="Shop.vue";a["default"]=d.exports}}]);