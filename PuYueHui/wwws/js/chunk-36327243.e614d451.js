(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-36327243"],{"85a5":function(t,s,a){"use strict";var i=a("e494"),e=a.n(i);e.a},e494:function(t,s,a){},f5f6:function(t,s,a){"use strict";a.r(s);var i=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",[a("div",{staticClass:"flexlayout"},[a("div",{staticClass:"topbar"},[a("router-link",{staticClass:"icon icon-sousuo",attrs:{to:"/search"}}),a("div",[t._v("葡悦汇商城")]),a("span",{staticClass:"icon"})],1),a("div",{staticClass:"filterBar"},[a("span",{class:{cur:1==t.searchParam.field},on:{click:function(s){t.doSearch("1")}}},[t._v("综合")]),a("span",{staticClass:"i-rev",class:[{cur:2==t.searchParam.field},t.orderClass.soldNumBy?"i-rev":"i-sor"],on:{click:function(s){t.doSearch("2")}}},[t._v("销量")]),a("span",{class:[{cur:3==t.searchParam.field},t.orderClass.capacityBy?"i-rev":"i-sor"],on:{click:function(s){t.doSearch("3")}}},[t._v("容量")]),a("span",{class:[{cur:4==t.searchParam.field},t.orderClass.priceBy?"i-rev":"i-sor"],on:{click:function(s){t.doSearch("4")}}},[t._v("价格")]),a("span",{staticClass:"icon-shaixuan",on:{click:function(s){t.onShow()}}},[t._v("筛选")])]),a("div",{staticClass:"productBox"},[a("mt-loadmore",{ref:"loadmore",attrs:{"bottom-method":t.pageList,"auto-fill":!1,"bottom-all-loaded":t.allLoaded}},[t.products?a("div",{staticClass:"list_pho2",attrs:{id:"product_list"}},t._l(t.products,function(s,i){return a("router-link",{key:i,attrs:{to:{name:"ProductDetail",query:{id:s.id}}}},[a("div",{staticClass:"wrap_img"},[a("img",{attrs:{src:t.attachmentUrl+s.logo+".jpg",alt:s.name}})]),a("p",{staticClass:"cp_title"},[t._v(t._s(s.name))]),a("p",{staticClass:"price"},[t._v("会员价：￥"+t._s(s.price))]),a("p",{staticClass:"price2"},[t._v("\n              零售价：\n              "),a("span",[t._v(t._s(t._f("formatMoney")(s.originalPrice)))])])])}),1):t._e()])],1),a("MainMenu",{staticClass:"menuBox"})],1),a("mt-popup",{staticClass:"filterBox",attrs:{position:"right",modal:!0},model:{value:t.popupVisible,callback:function(s){t.popupVisible=s},expression:"popupVisible"}},[a("div",{staticStyle:{height:"100%",overflow:"auto"}},[a("h2",{staticClass:"filterTitle"},[a("strong",[t._v("类型")]),a("span")]),a("div",{staticClass:"filerItem"},t._l(t.typeList,function(s,i){return a("span",{key:s.key,class:{"cur icon-cur":s.checked},on:{click:function(a){t.typeClick(s)}}},[t._v(t._s(s.value))])}),0),a("h2",{staticClass:"filterTitle"},[a("strong",[t._v("国家")]),a("span")]),a("div",{staticClass:"filerItem"},t._l(t.areaList,function(s,i){return a("span",{key:s.key,class:{"cur icon-cur":s.checked},on:{click:function(a){t.typeClick(s)}}},[t._v(t._s(s.value))])}),0),a("h2",{staticClass:"filterTitle"},[a("strong",[t._v("价格")]),a("span")]),a("div",{staticClass:"filerItem"},t._l(t.priceList,function(s,i){return a("span",{key:s.key,class:{"cur icon-cur":s.checked},on:{click:function(a){t.typeClick(s,1)}}},[t._v(t._s(s.value))])}),0),a("h2",{staticClass:"filterTitle"},[a("strong",[t._v("产地")]),a("span")]),a("div",{staticClass:"filerItem"},t._l(t.chateauList,function(s,i){return a("span",{key:s.key,class:{"cur icon-cur":s.checked},on:{click:function(a){t.typeClick(s)}}},[t._v(t._s(s.value))])}),0)]),a("div",{staticClass:"btngroup"},[a("div",{staticClass:"btn2",on:{click:function(s){t.onHide()}}},[t._v("取消")]),a("div",{staticClass:"btn3",on:{click:function(s){t.search()}}},[t._v("确认")])])])],1)},e=[],r=(a("386d"),a("ac6a"),a("cadf"),a("551c"),a("097d"),a("add6")),c=a("38cc"),o=a("3a78"),n=(a("76a0"),{name:"Shop",components:{MainMenu:r["a"],Listpho2:c["a"]},data:function(){return{attachmentUrl:this.GLOBAL.attachmentUrl,products:[],code:"",msg:"",baseUrl:o["a"].baseUrl,popupVisible:!1,priceList:[],areaList:[],chateauList:[],typeList:[],searchParam:{priceRange:"",area:"",chateauId:"",classify:"",pageNo:1,pageSize:10,orderBy:"1",field:"1"},allLoaded:!1,orderClass:{soldNumBy:!1,capacityBy:!1,priceBy:!1}}},computed:{},created:function(){var t=this,s={pageNo:1,pageSize:10,orderBy:t.searchParam.orderBy,field:t.searchParam.field};this.searchProduct(s),this.doConfig()},methods:{doSearch:function(t){this.resetPage(),this.searchParam.field=t,this.switchOrderStyle(t),this.searchProduct(this.searchParam)},searchProduct:function(t,s){var a=this;return new Promise(function(i,e){o["a"].products(t,function(t){a.products=s?a.products.concat(t.list):t.list,i(t.pages)},function(t){console.log("my---errorDatassss==="+JSON.stringify(t)),e()})})},doConfig:function(){var t=this;o["a"].searchConfig({},function(s){null!=s&&(t.priceList=t.wrap(s.price_type),t.areaList=t.wrap(s.country_type),t.chateauList=t.wrap(s.chateau_type),t.typeList=t.wrap(s.wine_type))},function(t){})},typeClick:function(t,s){1==s&&this.priceList.forEach(function(t,s){t.checked=!1}),t.checked=!t.checked},addToShoppingCart:function(t){var s={productId:t.id,productQuantity:1,currentPrice:t.price};o["a"].addToShoppingCart(s,function(t){console.log("添加购物车成功:",s)},function(t){console.error("添加购物车异常:",JSON.stringify(t))})},onShow:function(){this.popupVisible=!0},onHide:function(){this.popupVisible=!1,this.wrap(this.priceList),this.wrap(this.areaList),this.wrap(this.chateauList),this.wrap(this.typeList),this.search()},search:function(){this.popupVisible=!1,this.resetPage(),this.searchParam.classify=this.selectList(this.typeList),this.searchParam.priceRange=this.selectList(this.priceList),this.searchParam.chateauId=this.selectList(this.chateauList),this.searchParam.area=this.selectList(this.areaList),this.searchProduct(this.searchParam)},wrap:function(t){var s=this;return t.forEach(function(t){s.$set(t,"checked",!1)}),t},selectList:function(t){var s="";return t.forEach(function(t){t.checked&&(s.length>0&&(s+=","),s+=t.key)}),s},pageList:function(){event.stopImmediatePropagation(),this.searchParam.pageNo++;var t=this,s={pageNo:t.searchParam.pageNo,pageSize:10,orderBy:t.searchParam.orderBy,field:t.searchParam.field};this.searchProduct(s,!0).then(function(s){s==t.searchParam.pageNo&&(t.allLoaded=!0),t.$refs.loadmore.onBottomLoaded()}).catch(function(s){t.$refs.loadmore.onBottomLoaded()})},switchOrderStyle:function(t){switch(t){case"2":this.orderClass.soldNumBy=!this.orderClass.soldNumBy,this.searchParam.orderBy=this.getOrderBy(this.orderClass.soldNumBy);break;case"3":this.orderClass.capacityBy=!this.orderClass.capacityBy,this.searchParam.orderBy=this.getOrderBy(this.orderClass.capacityBy);break;case"4":this.orderClass.priceBy=!this.orderClass.priceBy,this.searchParam.orderBy=this.getOrderBy(this.orderClass.priceBy);break}},getOrderBy:function(t){return t?"1":"2"},resetPage:function(){this.searchParam.pageNo=1,this.searchParam.orderBy="1",this.searchParam.field="1",this.allLoaded=!1}}}),l=n,h=(a("85a5"),a("2877")),d=Object(h["a"])(l,i,e,!1,null,"155e0bb0",null);d.options.__file="Shop.vue";s["default"]=d.exports}}]);